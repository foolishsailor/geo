!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.geo=e():t.geo=e()}(window,(function(){return function(t){var e={};function a(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=1)}([function(t,e){validateBearings=(t,e)=>{let a=[];return t.forEach((function(t,n){if(isNaN(t)||t>=360||t<0||null===t)return a.push({index:n,value:t});e||"string"!=typeof t||a.push({index:n,value:t})})),a},processPointData=t=>{try{let e=[];for(let n=0;n<t.length;n++){const r=t[n];if(Math.abs(r.lat)>90)throw"Latitude out of bounds";if(Math.abs(r.lon)>180)throw"Longitude out of bounds";if(r.lat=a(r.lat),r.lon=a(r.lon),isNaN(r.lat)||isNaN(r.lon))throw"Malformed Position Data";e.push(r)}return e}catch(t){throw{error:"GPS Position Error",message:t}}},validateDMSstring=(t,e)=>{if(Math.abs(e[0])>180)throw"Position out of bounds";if(/[NS]/i.test(t)&&Math.abs(e[0])>90)throw"Latitude out of bounds";switch(e.length){case 3:if(e[1]>60||e[2]>60)throw"DMS minutes out of bounds";case 2:if(e[1]>60)throw"DMS seconds out of bounds";default:return}};const a=t=>{if(!isNaN(parseFloat(t))&&isFinite(t))return Number(t);let e,a=t.replace(/^-/,"").replace(/[NSEW]/i,""),n=a.split(/[^0-9.,]+/);try{switch(n.forEach((t,e)=>{if(""==t){if(e<n.length-1)throw"Malformed Position Data";n.splice(e,1)}}),validateDMSstring(t,n),n.length){case 3:e=n[0]/1+n[1]/60+n[2]/3600;break;case 2:e=n[0]/1+n[1]/60;break;case 1:/[NS]/i.test(t)&&(a="0"+a),e=n[0].slice(0,3)/1+n[0].slice(3,5)/60+n[0].slice(5)/3600;break;default:return NaN}}catch(t){return NaN}return(/^-/.test(t)||/[WS]/i.test(t))&&(e=-e),e.toFixedNumber(7)};t.exports={validateBearings:validateBearings,processPointData:processPointData,validateDMSstring:validateDMSstring,parseDMS:a}},function(t,e,a){a(2);const{geo_const:n}=a(3),{parseDMS:r}=a(0),{bearings:o}=a(4);t.exports={getAvgOfBearings:o.getAvgOfBearings,getBearingBetweenTwoPoints:o.getBearingBetweenTwoPoints,getBearingDiff:o.getBearingDiff,addHeading:o.addHeading,invertHDG:o.invertHDG,findMiddleAngle:o.findMiddleAngle,parseDMS:o.parseDMS,getBoundsOfData:t=>{t.reduce((function(t,e){return{latMin:isNaN(t.latMin)||t.latMin>e.lat?e.lat:t.latMin,latMax:isNaN(t.latMax)||t.latMax<e.lat?e.lat:t.latMax,lngMin:isNaN(t.lngMin)||t.lngMin>e.lng?e.lng:t.lngMin,lngMax:isNaN(t.lngMax)||t.lngMax<e.lng?e.lng:t.lngMax}}),{latMin:1/0,latMax:-1/0,lngMin:1/0,lngMax:-1/0})},getDistanceCos:(t,e,a)=>{let r=a||n.MEAN_RADIUS_IN_M/1e3;return Math.acos(Math.sin(t.lat*Math.PI/180)*Math.sin(e.lat*Math.PI/180)+Math.cos(t.lat*Math.PI/180)*Math.cos(e.lat*Math.PI/180)*Math.cos((e.lon-t.lon)*Math.PI/180))*r},getDistanceHaversine:(t,e)=>{let a=n.MEAN_RADIUS_IN_M/1e3,r=(e.lat-t.lat)*Math.PI/180,o=(e.lon-t.lon)*Math.PI/180;t.lat=t.lat*Math.PI/180,e.lat=e.lat*Math.PI/180;let i=Math.sin(r/2)*Math.sin(r/2)+Math.cos(t.lat)*Math.cos(e.lat)*Math.sin(o/2)*Math.sin(o/2);return a*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))},getDistanceFromSpeedTime:(t,e)=>({distInDegree:t*(e/n.HOUR)/n.KM_IN_DEG,distInFeet:t*(e/n.HOUR)*n.KM_TO_FEET,distInKilometers:t*(e/n.HOUR),distInNM:t*(e/n.HOUR)*n.KM_TO_NM}),getPostionFromBearingAndDistance:(t,e,a)=>{let r={lat:t.lat(),lng:t.lng()};dist=e/n.MEAN_RADIUS_IN_M/1e3;let o=Number(a)*Math.PI/180,i=r.lat;i=i*Math.PI/180;let s=r.lng;s=s*Math.PI/180;let l=Math.asin(Math.sin(i)*Math.cos(dist)+Math.cos(i)*Math.sin(dist)*Math.cos(o)),M=s+Math.atan2(Math.sin(o)*Math.sin(dist)*Math.cos(i),Math.cos(dist)-Math.sin(i)*Math.sin(l));return{lat:180*l/Math.PI,lng:180*M/Math.PI}},getIntersection:({lineA:t,lineB:e})=>{let a=t.start.lon-t.end.lon,n=e.start.lon-e.end.lon,r=t.start.lat-t.end.lat,o=e.start.lat-e.end.lat,i=a*o-r*n;if(0==i)return!1;let s=t.start.lon*t.end.lat-arrs.lineA.start.lat*t.end.lon,l=e.start.lon*e.end.lat-e.start.lat*e.end.lon;return{lat:(s*o-l*r)/i,lon:(s*n-l*a)/i}},crossTrackDistanceTo:function({lineStart:t,lineEnd:e,currentPoint:a,haversine:r=!1}){let o=r?this.getDistanceHaversine(t,a,n.MEAN_RADIUS_IN_M)/n.MEAN_RADIUS_IN_M:this.getDistanceCos(t,a,n.MEAN_RADIUS_IN_M)/n.MEAN_RADIUS_IN_M,i=this.getBearingBetweenTwoPoints(t,a)*(Math.PI/180),s=this.getBearingBetweenTwoPoints(t,e)*(Math.PI/180);return Math.asin(Math.sin(o)*Math.sin(i-s))*n.MEAN_RADIUS_IN_M},getMinMaxAvgFromArray:t=>{let e=t.reduce((function(t,e){return(isNaN(t)||null===t||""===t)&&(t=-1/0),(isNaN(e)||null===e||""===e)&&(e=-1/0),Math.max(t,e)}),-1/0);return{min:t.reduce((function(t,e){return(isNaN(t)||null===t||""===t)&&(t=1/0),(isNaN(e)||null===e||""===e)&&(e=1/0),Math.min(t,e)}),1/0),max:e,avg:t.reduce((function(t,e){return isNaN(e)||null===e||""===e?t:t+Number(e)}),0)/t.length}},mercator:({latitude:t,longitude:e})=>{const a=85.0511287798,r=Math.PI/180;let o={};return o.lon=n.RADIUS_IN_M*e*r,o.lat=Math.max(Math.min(a,t),-a)*r,o.lat=n.RADIUS_IN_M*Math.log(Math.tan(Math.PI/4+o.lat/2)),o},humanTime:t=>{let e=(t/1e3).toFixed(0),a=Math.floor(e/60),n="";return a>59&&(n=Math.floor(a/60),n=n>=10?n:"0"+n,a-=60*n,a=a>=10?a:"0"+a),e=Math.floor(e%60),e=e>=10?e:"0"+e,""!=n?n+":"+a+":"+e:a+":"+e},GDP_smoother:function(t,e){let a,n,r,o,i,s,l,M,u,h,c,d,g,f,N,p,_,D,I,b=Math.PI/180*.5,m=new Array,P=new Array,S=new Array;if(t.length<3)return t;for(a=t.length,h=360*e/(2*Math.PI*6378137),h*=h,r=0,P[0]=0,S[0]=a-1,n=1;n>0;)if(o=P[n-1],i=S[n-1],n--,i-o>1){for(c=t[i].lon-t[o].lon,d=t[i].lat-t[o].lat,Math.abs(c)>180&&(c=360-Math.abs(c)),c*=Math.cos(b*(t[i].lat+t[o].lat)),g=c*c+d*d,s=o+1,l=o,u=-1;s<i;s++)f=t[s].lon-t[o].lon,N=t[s].lat-t[o].lat,Math.abs(f)>180&&(f=360-Math.abs(f)),f*=Math.cos(b*(t[s].lat+t[o].lat)),p=f*f+N*N,_=t[s].lon-t[i].lon,D=t[s].lat-t[i].lat,Math.abs(_)>180&&(_=360-Math.abs(_)),_*=Math.cos(b*(t[s].lat+t[i].lat)),I=_*_+D*D,M=p>=g+I?I:I>=g+p?p:(f*d-N*c)*(f*d-N*c)/g,M>u&&(l=s,u=M);u<h?(m[r]=o,r++):(n++,P[n-1]=l,S[n-1]=i,n++,P[n-1]=o,S[n-1]=l)}else m[r]=o,r++;m[r]=a-1,r++;let A=new Array;for(let e=0;e<r;e++)A.push(t[m[e]]);return A}}},function(t,e,a){const{parseDMS:n}=a(0);Number.prototype.toFixedNumber=function(t,e){var a=Math.pow(e||10,t);return Math.round(this*a)/a},Number.prototype.toRad=function(){return this*Math.PI/180},Number.prototype.toDeg=function(){return 180*this/Math.PI},Number.prototype.toBNG=function(){return(this.toDeg()+360)%360},Number.prototype.toDMS=function(){let t=Math.abs(this);t+=1/7200;let e=Math.floor(t),a=Math.floor(60*(t-e)),n=Number((3600*(t-e-a/60)).toFixed(2));return e<100&&(e="0"+e),e<10&&(e="0"+e),a<10&&(a="0"+a),n<10&&(n="0"+n),`${e}Â°${a}'${n}"`},Number.prototype.toLat=function(){return this.toDMS().slice(1)+(this<0?"S":"N")},Number.prototype.toLon=function(){return this.toDMS()+(this>0?"E":"W")},String.prototype.parseDMS=function(){return n(this)}},function(t,e){t.exports={geo_const:{KM_TO_NM:.539957,NM_TO_KM:1.852,HOUR:3600,KM_IN_DEG:111.12,NM_IN_DEG:60,NM_TO_FEET:6076,KM_TO_FEET:3280.84,RADIUS_IN_M:6378137,MEAN_RADIUS_IN_M:6371e3}}},function(t,e,a){const{validateBearings:n,processPointData:r}=a(0);t.exports={getAvgOfBearings:t=>{try{if(t.length<2)throw"Less than two bearings";let e=n(t);if(e.length>0)throw e;let a=t.reduce((function(t,e){return{sinValue:t.sinValue+=Math.sin(e.toRad()),cosValue:t.cosValue+=Math.cos(e.toRad())}}),{sinValue:0,cosValue:0}),r=Math.atan2(a.sinValue,a.cosValue),o=r.toDeg();return o<=-1&&(o+=359),{degrees:Math.abs(Math.round(100*o)/100),radians:r}}catch(t){return{error:"Invalid Bearings",message:t}}},getBearingBetweenTwoPoints:(t,e,a=0)=>{try{const[n,o]=r([t,e]);let i=n.lat.toRad(),s=o.lat.toRad(),l=(o.lon-n.lon).toRad(),M=Math.sin(l)*Math.cos(s),u=Math.cos(i)*Math.sin(s)-Math.sin(i)*Math.cos(s)*Math.cos(l);return((Math.atan2(M,u).toDeg()+360)%360).toFixedNumber(a)}catch(t){return t}},getBearingDiff:(t,e)=>Math.min(t-e<0?t-e+360:t-e,e-t<0?e-t+360:e-t),addHeading:(t,e)=>(hdg=t+e,hdg<0&&(hdg+=360),hdg>=360&&(hdg-=360),hdg),invertHDG:t=>((t+=180)<0&&(t+=360),t>=360&&(t-=360),t),findMiddleAngle:(t,e)=>{t=Math.round(t),e=Math.round(e);let a=this.getBearingDiff(t,e);return this.addHeading(t,a)==e?this.addHeading(t,a/2):this.addHeading(t,-1*a/2)}}}])}));
//# sourceMappingURL=geo.min.js.map